<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://fanlu.top</id>
    <title>何妨吟啸且徐行 • Posts by &#34;工具 网络&#34; tag</title>
    <link href="https://fanlu.top" />
    <updated>2023-08-27T05:41:39.000Z</updated>
    <category term="CI CD linux" />
    <category term="测试开发 性能 工具" />
    <category term="前端 产品经理" />
    <category term="前端 UI" />
    <category term="golang实验室" />
    <category term="工具 网络" />
    <category term="jenkins CD" />
    <category term="前端 动画 工具" />
    <category term="前端 工具" />
    <category term="前端搬砖指南" />
    <category term="前端 vue go wasm" />
    <category term="阅读 经济" />
    <category term="生活" />
    <category term="云服务器" />
    <category term="工具" />
    <category term="nuxt axiss 前端" />
    <category term="阅读 电影 电视" />
    <category term="阅读 电视 播客" />
    <category term="阅读 UP主" />
    <category term="阅读" />
    <category term="游戏 桌游 生活" />
    <category term="前端 网站" />
    <category term="前端 UI 网站" />
    <category term="阅读 记录" />
    <category term="鸡毛蒜皮周刊" />
    <entry>
        <id>https://fanlu.top/2023/08/27/grpcurl/</id>
        <title>grpcurl</title>
        <link rel="alternate" href="https://fanlu.top/2023/08/27/grpcurl/"/>
        <content type="html">&lt;h2 id=&#34;curl&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#curl&#34;&gt;#&lt;/a&gt; cURL&lt;/h2&gt;
&lt;p&gt;curl 是一个常见的命令行工具，用来请求 web 服务器接口，c 就是 client 的意思。&lt;br&gt;
curl 支持的协议很多&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;http&lt;/li&gt;
&lt;li&gt;https&lt;/li&gt;
&lt;li&gt;FTP&lt;/li&gt;
&lt;li&gt;SCP&lt;/li&gt;
&lt;li&gt;SMTP&lt;/li&gt;
&lt;li&gt;Websockect&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其使用方法可以参考这里： &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cucnVhbnlpZmVuZy5jb20vYmxvZy8yMDE5LzA5L2N1cmwtcmVmZXJlbmNlLmh0bWw=&#34;&gt;https://www.ruanyifeng.com/blog/2019/09/curl-reference.html&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;但是 grpc 是不支持的.&lt;/p&gt;
&lt;h2 id=&#34;grpcurl&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#grpcurl&#34;&gt;#&lt;/a&gt; grpcurl&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2Z1bGxzdG9yeWRldi9ncnBjdXJs&#34;&gt;grpcurl&lt;/span&gt; 就是用来支持 grpc 的一个工具。&lt;br&gt;
支持功能包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;调用 RPC 接口，支持携带参数&lt;/li&gt;
&lt;li&gt;可以根据 proto 列出来所有的服务&lt;/li&gt;
&lt;li&gt;可以通过反射生成服务的描述&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;试用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#试用&#34;&gt;#&lt;/a&gt; 试用&lt;/h2&gt;
&lt;h3 id=&#34;环境搭建&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#环境搭建&#34;&gt;#&lt;/a&gt; 环境搭建&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;安装 go&lt;/li&gt;
&lt;li&gt;安装 grpcurl&lt;/li&gt;
&lt;li&gt;proto 生成相关（非必须）&lt;br&gt;
这里就不赘述了。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;启动grpc服务&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#启动grpc服务&#34;&gt;#&lt;/a&gt; 启动 grpc 服务&lt;/h3&gt;
&lt;p&gt;首先本地起一个 grpc 服务，这里可以简单使用官方提供的模板。&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;git&lt;/span&gt; clone &lt;span class=&#34;token parameter variable&#34;&gt;-b&lt;/span&gt; v1.57.0 &lt;span class=&#34;token parameter variable&#34;&gt;--depth&lt;/span&gt; &lt;span class=&#34;token number&#34;&gt;1&lt;/span&gt; https://github.com/grpc/grpc-go&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;cd&lt;/span&gt; grpc-go/examples/helloworld&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;修改服务，因为 grpcurl 需要服务器支持反射&lt;/p&gt;
&lt;figure class=&#34;highlight go&#34;&gt;&lt;figcaption data-lang=&#34;go&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token comment&#34;&gt;// 修改 grpc-go/examples/helloworld/greeter_server/main.go&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;s &lt;span class=&#34;token operator&#34;&gt;:=&lt;/span&gt; grpc&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;NewServer&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;reflection&lt;span class=&#34;token punctuation&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;token function&#34;&gt;Register&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;s&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;token comment&#34;&gt;// 添加这一行&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;然后启动服务&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;go run main.go&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;使用grpcurl&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#使用grpcurl&#34;&gt;#&lt;/a&gt; 使用 grpcurl&lt;/h3&gt;
&lt;h4 id=&#34;列举服务&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#列举服务&#34;&gt;#&lt;/a&gt; 列举服务&lt;/h4&gt;
&lt;p&gt;因为本地不是 tls 服务，需要加 - plaintext&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;base&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; PS C:&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;Users&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;fanlu&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; grpcurl &lt;span class=&#34;token parameter variable&#34;&gt;-plaintext&lt;/span&gt; localhost:50051 list&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grpc.reflection.v1.ServerReflection&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;grpc.reflection.v1alpha.ServerReflection&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;helloworld.Greeter&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;5&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;6&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;// 指定service&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;7&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;base&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; PS C:&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;Users&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;fanlu&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; grpcurl &lt;span class=&#34;token parameter variable&#34;&gt;-plaintext&lt;/span&gt; localhost:50051 list helloworld.Greeter&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;8&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;helloworld.Greeter.SayHello&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h4 id=&#34;描述协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#描述协议&#34;&gt;#&lt;/a&gt; 描述协议&lt;/h4&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;base&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; PS C:&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;Users&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;fanlu&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; grpcurl &lt;span class=&#34;token parameter variable&#34;&gt;-plaintext&lt;/span&gt; localhost:50051 describe helloworld.Greeter.SayHello&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;helloworld.Greeter.SayHello is a method:&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;rpc SayHello &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt; .helloworld.HelloRequest &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; returns &lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt; .helloworld.HelloReply &lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;token punctuation&#34;&gt;;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h4 id=&#34;调用协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#调用协议&#34;&gt;#&lt;/a&gt; 调用协议&lt;/h4&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;(&lt;/span&gt;base&lt;span class=&#34;token punctuation&#34;&gt;)&lt;/span&gt; PS C:&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;Users&lt;span class=&#34;token punctuation&#34;&gt;\&lt;/span&gt;fanlu&lt;span class=&#34;token operator&#34;&gt;&gt;&lt;/span&gt; grpcurl &lt;span class=&#34;token parameter variable&#34;&gt;-plaintext&lt;/span&gt; localhost:50051 helloworld.Greeter.SayHello&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#123;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;3&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;  &lt;span class=&#34;token string&#34;&gt;&#34;message&#34;&lt;/span&gt;&lt;span class=&#34;token builtin class-name&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;token string&#34;&gt;&#34;Hello &#34;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;4&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token punctuation&#34;&gt;&amp;#125;&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h2 id=&#34;注意要区分大小写&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#注意要区分大小写&#34;&gt;#&lt;/a&gt; 注意：要区分大小写！&lt;/h2&gt;
&lt;p&gt;更复杂的用法还没用过。&lt;/p&gt;
</content>
        <category term="工具 网络" />
        <updated>2023-08-27T05:41:39.000Z</updated>
    </entry>
</feed>
