<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>何妨吟啸且徐行 • Posts by &#34;jenkins&#34; tag</title>
        <link>https://fanlu.top</link>
        <description></description>
        <language>zh-CN</language>
        <pubDate>Sun, 20 Aug 2023 07:54:23 +0000</pubDate>
        <lastBuildDate>Sun, 20 Aug 2023 07:54:23 +0000</lastBuildDate>
        <category>CI</category>
        <category>CD</category>
        <category>linux</category>
        <category>jenkins</category>
        <category>云服务器</category>
        <category>前端</category>
        <category>UI</category>
        <category>产品经理</category>
        <category>动画</category>
        <category>工具</category>
        <category>前端搬砖指南</category>
        <category>nuxt</category>
        <category>axiss</category>
        <category>vue</category>
        <category>go</category>
        <category>wasm</category>
        <category>网站</category>
        <category>自动化测试</category>
        <category>测试开发</category>
        <category>性能</category>
        <category>网络</category>
        <category>golang</category>
        <category>golang实验室</category>
        <category>ios</category>
        <category>DEBUG</category>
        <category>python</category>
        <category>游戏</category>
        <category>桌游</category>
        <category>生活</category>
        <category>阅读</category>
        <category>经济</category>
        <category>记录</category>
        <category>电影</category>
        <category>电视</category>
        <category>播客</category>
        <category>UP主</category>
        <category>鸡毛蒜皮周刊</category>
        <item>
            <guid isPermalink="true">https://fanlu.top/2023/08/20/CI/jenkins%E7%9A%84%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</guid>
            <title>jenkins的部署问题记录</title>
            <link>https://fanlu.top/2023/08/20/CI/jenkins%E7%9A%84%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</link>
            <category>CD</category>
            <category>jenkins</category>
            <pubDate>Sun, 20 Aug 2023 07:54:23 +0000</pubDate>
            <description><![CDATA[ &lt;p&gt;因为工作的原因，需要给外包同学部署一个 jenkins 来帮助他们部署一些东西。&lt;/p&gt;
&lt;h2 id=&#34;docker方式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#docker方式&#34;&gt;#&lt;/a&gt; docker 方式&lt;/h2&gt;
&lt;p&gt;一开始使用 docker 方式部署 jenkins，简单快速又方便。很快就部署好了。&lt;br&gt;
但是 docker 是一个容器，而要进行 CI、CD 的项目是在宿主机上，查了下，在 jenkins 上安装了一个 pushover ssh 插件，等于是用 ssh 登录的方式来执行宿主机上面的脚本。&lt;br&gt;
然而，这种是获取不到脚本的输出的，也无法真正判断脚本是否执行成功（可能也有办法判断，我没有深入研究）。&lt;br&gt;
再加上服务器宕机了一次，脚本怎么也跑不起来了。于是还是决定直接装一个非 docker 的 jenkins 服务。&lt;/p&gt;
&lt;h2 id=&#34;非docker方式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#非docker方式&#34;&gt;#&lt;/a&gt; 非 docker 方式&lt;/h2&gt;
&lt;p&gt;按照&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9wa2cuamVua2lucy5pby9yZWRoYXQtc3RhYmxlLw==&#34;&gt;官网说明&lt;/span&gt;，很快就装好了。&lt;br&gt;
启动后遇到两个问题。&lt;/p&gt;
&lt;h3 id=&#34;修改默认端口&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#修改默认端口&#34;&gt;#&lt;/a&gt; 修改默认端口&lt;/h3&gt;
&lt;p&gt;一般是修改 &lt;code&gt;/etc/sysconfig/jenkins&lt;/code&gt;  里面的 &lt;code&gt;JENKINS_PORT&lt;/code&gt;  来修改，但是一直不生效。原来新版的 jenkins 必须修改这里：&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;vim&lt;/span&gt; /usr/lib/systemd/system/jenkins.service&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-num=&#34;2&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;找到Environment&lt;span class=&#34;token operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;token string&#34;&gt;&#34;JENKINS_PORT=8080&#34;&lt;/span&gt;,把端口修改掉就行了&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h3 id=&#34;修改启动用户&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#修改启动用户&#34;&gt;#&lt;/a&gt; 修改启动用户&lt;/h3&gt;
&lt;p&gt;默认的启动用户是 jenkins/jenkins。 但是很多脚本是在其他用户目录下，jenkins 用户是没有权限的。&lt;br&gt;
我就把他修改为 dev 用户。&lt;br&gt;
一开始也是修改 &lt;code&gt;/etc/sysconfig/jenkins&lt;/code&gt;  里面的 &lt;code&gt;JENKINS_USER&lt;/code&gt; ，还是不生效，后来还是修改这里&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;vim /usr/lib/systemd/system/jenkins.service
文件最开头的user、group修改成你需要的用户和用户组就行了
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;修改过后，记得重载配置文件&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;systemctl daemon-reload
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;然后重启服务就行了&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;figcaption data-lang=&#34;Bash&#34;&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td data-num=&#34;1&#34;&gt;&lt;/td&gt;&lt;td&gt;&lt;pre&gt;&lt;span class=&#34;token function&#34;&gt;service&lt;/span&gt; jenkins restart&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
    </channel>
</rss>
