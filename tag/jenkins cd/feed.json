{
    "version": "https://jsonfeed.org/version/1",
    "title": "何妨吟啸且徐行 • All posts by \"jenkins cd\" tag",
    "description": "",
    "home_page_url": "https://fanlu.top",
    "items": [
        {
            "id": "https://fanlu.top/2023/08/20/jenkins%E7%9A%84%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "url": "https://fanlu.top/2023/08/20/jenkins%E7%9A%84%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "title": "jenkins的部署问题记录",
            "date_published": "2023-08-20T07:54:23.000Z",
            "content_html": "<p>因为工作的原因，需要给外包同学部署一个 jenkins 来帮助他们部署一些东西。</p>\n<h2 id=\"docker方式\"><a class=\"markdownIt-Anchor\" href=\"#docker方式\">#</a> docker 方式</h2>\n<p>一开始使用 docker 方式部署 jenkins，简单快速又方便。很快就部署好了。<br>\n但是 docker 是一个容器，而要进行 CI、CD 的项目是在宿主机上，查了下，在 jenkins 上安装了一个 pushover ssh 插件，等于是用 ssh 登录的方式来执行宿主机上面的脚本。<br>\n然而，这种是获取不到脚本的输出的，也无法真正判断脚本是否执行成功（可能也有办法判断，我没有深入研究）。<br>\n再加上服务器宕机了一次，脚本怎么也跑不起来了。于是还是决定直接装一个非 docker 的 jenkins 服务。</p>\n<h2 id=\"非docker方式\"><a class=\"markdownIt-Anchor\" href=\"#非docker方式\">#</a> 非 docker 方式</h2>\n<p>按照<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wa2cuamVua2lucy5pby9yZWRoYXQtc3RhYmxlLw==\">官网说明</span>，很快就装好了。<br>\n启动后遇到两个问题。</p>\n<h3 id=\"修改默认端口\"><a class=\"markdownIt-Anchor\" href=\"#修改默认端口\">#</a> 修改默认端口</h3>\n<p>一般是修改 <code>/etc/sysconfig/jenkins</code>  里面的 <code>JENKINS_PORT</code>  来修改，但是一直不生效。原来新版的 jenkins 必须修改这里：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /usr/lib/systemd/system/jenkins.service</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>找到Environment<span class=\"token operator\">=</span><span class=\"token string\">\"JENKINS_PORT=8080\"</span>,把端口修改掉就行了</pre></td></tr></table></figure><h3 id=\"修改启动用户\"><a class=\"markdownIt-Anchor\" href=\"#修改启动用户\">#</a> 修改启动用户</h3>\n<p>默认的启动用户是 jenkins/jenkins。 但是很多脚本是在其他用户目录下，jenkins 用户是没有权限的。<br>\n我就把他修改为 dev 用户。<br>\n一开始也是修改 <code>/etc/sysconfig/jenkins</code>  里面的 <code>JENKINS_USER</code> ，还是不生效，后来还是修改这里</p>\n<pre><code>vim /usr/lib/systemd/system/jenkins.service\n文件最开头的user、group修改成你需要的用户和用户组就行了\n</code></pre>\n<p>修改过后，记得重载配置文件</p>\n<pre><code>systemctl daemon-reload\n</code></pre>\n<p>然后重启服务就行了</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">service</span> jenkins restart</pre></td></tr></table></figure>",
            "tags": [
                "jenkins CD"
            ]
        }
    ]
}